parameters:
  name: ''
  vmImage: ''
  configuration: ''

jobs:
  - job: deployLocalhost${{ parameters.name }}
    displayName: Deploy - localhost - ${{ parameters.configuration }}
    pool:
      vmImage: ${{ parameters.vmImage }}
    variables:
    - group: docker-registry-localhost

    steps:
    - template: azure-pipelines.cd.deploy.yml
      parameters:
        configuration: ${{ parameters.configuration }}
        dockerRegistryServiceConnection: $(docker-registry-service-connection)

  - job: deployDockerIo${{ parameters.name }}
    displayName: Deploy - docker.io - ${{ parameters.configuration }}
    pool:
      vmImage: ${{ parameters.vmImage }}
    variables:
    - group: docker-registry-dockerio
    dependsOn: deployLocalhost${{ parameters.name }}

    steps:
    - template: azure-pipelines.cd.deploy.yml
      parameters:
        configuration: ${{ parameters.configuration }}
        dockerRegistryServiceConnection: $(docker-registry-service-connection)
